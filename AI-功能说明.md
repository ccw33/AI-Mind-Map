# AI思维导图功能说明

## 🎯 功能概述

我们在原有的思维导图基础上集成了AI聊天助手功能，实现了智能的思维导图扩展和内容生成。

## ✨ 主要功能

### 1. AI聊天浮窗 ✅
- **位置**: 页面右下角
- **功能**: 与AI助手进行对话，获取思维导图扩展建议
- **特性**:
  - 可最小化/展开
  - 支持多轮对话
  - 智能建议提取
  - 现代化UI设计

### 2. 节点感知对话 ✅
- **自动检测**: 当用户点击思维导图节点时，AI会自动感知选中的节点
- **上下文对话**: AI会基于选中的节点内容提供相关建议
- **快速操作**: 提供"扩展节点"、"解释概念"、"应用场景"等快速操作按钮
- **实时更新**: 选中节点信息实时显示在聊天窗口标题栏

### 3. 智能建议系统 ✅
- **💡 AI建议**: AI会从回复中自动提取可添加到思维导图的建议
- **一键添加**: 点击建议按钮可直接将内容添加为思维导图的子节点
- **多种类型**: 支持添加子节点和兄弟节点
- **即时反馈**: 添加成功后显示通知提示

### 4. 结构化分点系统 ✅ **新功能**
- **📋 结构化分点**: AI提供详细的结构化内容分析
- **批量选择**: 支持复选框选择多个分点
- **全选功能**: 一键全选/取消全选所有分点
- **批量添加**: 选中的分点可批量添加到思维导图
- **关键词标签**: 每个分点包含相关关键词
- **详细内容**: 每个分点包含标题和详细描述

### 5. 多AI提供商支持 ✅
- **OpenAI**: 支持GPT系列模型
- **DeepSeek**: 支持DeepSeek模型
- **Ollama**: 支持本地部署的开源模型
- **配置管理**: 支持API Key、模型、基础URL等配置
- **连接测试**: 验证AI配置是否正确

### 6. 智能通知系统 ✅ **新功能**
- **成功通知**: 绿色通知显示操作成功
- **警告通知**: 橙色通知显示警告信息
- **错误通知**: 红色通知显示错误信息
- **自动消失**: 通知3秒后自动消失
- **动画效果**: 流畅的滑入滑出动画

## 🚀 使用方法

### 基础使用
1. 打开 `index.html` 文件
2. 等待思维导图加载完成
3. 在右下角会出现AI聊天浮窗
4. 点击思维导图节点开始对话

### 配置AI服务
1. 点击AI聊天浮窗右上角的⚙️设置按钮
2. 选择AI提供商（OpenAI/DeepSeek/Ollama）
3. 输入API Key和相关配置
4. 点击"保存配置"
5. 可选择"测试连接"验证配置

### 与AI对话
1. **选择节点**: 点击思维导图中的任意节点
2. **快速操作**: 使用"扩展节点"、"解释概念"等快速按钮
3. **自由对话**: 在输入框中输入任何问题
4. **添加建议**: 点击AI回复中的💡建议按钮，直接添加到思维导图

### 使用结构化分点 🆕
1. **获取分点**: AI回复会包含📋结构化分点
2. **选择分点**: 勾选想要添加的分点复选框
3. **批量操作**:
   - 点击"全选"选择所有分点
   - 点击"添加选中"批量添加到思维导图
4. **查看详情**: 每个分点包含：
   - 标题（主要概念）
   - 详细内容（具体描述）
   - 关键词标签（相关概念）

### 管理对话
- **最小化**: 点击⬇️按钮最小化聊天窗口
- **清除记录**: 点击🗑️按钮清除对话历史
- **键盘快捷键**: Enter发送消息，Shift+Enter换行

## 🔧 技术特性

### 智能上下文感知
- 自动获取选中节点的文本内容
- 基于节点上下文生成相关建议
- 支持多轮对话的上下文记忆

### 建议提取算法
- 自动识别AI回复中的列表项
- 提取适合作为思维导图节点的短语
- 过滤和优化建议内容

### 配置持久化
- 本地存储AI配置信息
- 自动加载上次保存的设置
- 支持多种AI提供商切换

### 响应式设计
- 适配不同屏幕尺寸
- 现代化的UI设计
- 流畅的动画效果

## 📝 配置示例

### OpenAI配置
```
提供商: OpenAI
API Key: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
模型: gpt-3.5-turbo
基础URL: https://api.openai.com/v1
```

### DeepSeek配置
```
提供商: DeepSeek
API Key: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
模型: deepseek-chat
基础URL: https://api.deepseek.com/v1
```

### Ollama配置
```
提供商: Ollama
API Key: (留空)
模型: llama2
基础URL: http://localhost:11434
```

## 🎨 界面说明

### AI聊天浮窗组件
- **标题栏**: 显示AI助手图标、标题和当前选中节点
- **消息区域**: 显示对话历史和AI建议
- **输入区域**: 文本输入框和发送按钮
- **操作按钮**: 清除、设置、最小化等功能

### 消息类型
- **用户消息**: 蓝色背景，右对齐
- **AI回复**: 灰色背景，左对齐，包含建议按钮
- **系统消息**: 蓝色边框，居中显示

### 状态指示
- **加载状态**: 显示"AI正在思考中..."
- **节点选中**: 标题栏显示当前选中节点
- **配置状态**: 根据API Key配置自动切换真实/模拟回复

## 🔍 故障排除

### 常见问题

**Q: AI不回复或回复错误**
A: 检查AI配置是否正确，特别是API Key和基础URL

**Q: 无法添加节点到思维导图**
A: 确保已选中思维导图节点，等待思维导图完全加载

**Q: 聊天窗口不显示**
A: 刷新页面，确保JavaScript正常加载

**Q: 配置无法保存**
A: 检查浏览器是否支持localStorage，清除浏览器缓存

### 调试方法
1. 打开浏览器开发者工具
2. 查看Console面板的错误信息
3. 检查Network面板的API请求状态
4. 验证localStorage中的配置数据

## 🚀 未来扩展

### 计划功能
- [ ] 支持更多AI提供商（Claude、Gemini等）
- [ ] 思维导图模板生成
- [ ] 批量节点生成
- [ ] 导出AI对话记录
- [ ] 自定义提示词模板
- [ ] 语音输入支持

### 技术优化
- [ ] 响应流式传输
- [ ] 离线模式支持
- [ ] 性能优化
- [ ] 移动端适配

## 📄 许可证

本项目基于原有思维导图项目，遵循相同的开源许可证。

---

**享受AI增强的思维导图体验！** 🧠✨
